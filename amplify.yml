version: 1
frontend:
  phases:
    preBuild:
      commands:
        - cd frontend
        - echo "Removing all node_modules and lock files..."
        - rm -rf node_modules package-lock.json
        - echo "Forcing exact React versions..."
        - npm install react@18.2.0 react-dom@18.2.0 scheduler@0.23.0 --save-exact --force
        - echo "Installing all dependencies..."
        - npm install --legacy-peer-deps
        - echo "Checking installed React version..."
        - npm list react react-dom
    build:
      commands:
        - echo "Building the project..."
        - npm run build
  artifacts:
    baseDirectory: frontend/build
    files:
      - '**/*'
  cache:
    paths:
      - frontend/node_modules/**/*
